<!DOCTYPE html>
<html lang="zh">
<head>
    <link rel="stylesheet" href="/static/css/spectre.css">
    <link rel="stylesheet" href="/static/css/spectre-icons.css">
    <link rel="stylesheet" href="/static/css/spectre-exp.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>考研看看</title>
</head>
<body>
<div>
    <header class="navbar p-fixed px-2"
            style="background-color: rgba(247,248,249,.9); z-index: 100; height: 3.5rem;width: 100%">
        <section class="navbar-section">
            <a href="." class="navbar-brand mr-2" style="font-size: larger;"><a class="btn">考研看看</a></a>
        </section>
        <section class="navbar-section">
            <form action="." method="get">
                <div class="input-group input-inline">
                    <input class="form-input" name="for-title" type="text" placeholder="文章标题">
                    <button class="btn input-group-btn" type="submit"><i class="form-icon icon icon-search"></i>
                    </button>
                </div>
            </form>
        </section>
    </header>
    <div class="container py-2" id="main-content">
        <h4 style="padding-top: 3.8rem">最新文章</h4>
        <div class="container">
            {{ range .cards }}

            <a class="card my-2 text-dark" href="{{ .DocURL }}">
                <div class="card-header h5"> {{ .Title }}</div>
                <div class="card-body">{{ .Content }}</div>
                <div class="card-footer">
                    <figure class="avatar avatar-sm">
                        <img class="s-circle"
                             src="{{ .Avatar }}">
                    </figure>
                    <span style="font-size: smaller">{{ .MpName }}</span>
                </div>
            </a>

            {{ end }}
            <!--点击加载-->
            <div class="flex-centered" id="main-end">
            <button class="btn" id="load-more" onclick="moreCards()" data="{{ .followTime }}"><i class="icon icon-downward"></i> 点击加载更多</button>
            </div>
        </div>
    </div>
</div>
<div class="divider text-center" data-content="-"></div>
<footer class="bg-gray">
    <div class="container py-2">
        <div><kbd class="bg-gray text-dark"><i class="icon icon-mail"></i> feiyu52@163.com</kbd></div>
        <div><kbd class="bg-gray text-dark">ICP备XXXXXXXX号</kbd></div>
    </div>
</footer>
<script src="../static/js/jquery-3.4.1.min.js"></script>
<script>
    function moreCards() {
        let lastTime = $("#load-more").attr("data");
        $.getJSON("/posts?followTime="+lastTime, function(data) {
            let cards = data["cards"];
            let followTime = data["followTime"];
            cards.forEach(function (card) {
                let x = "";
                let part = `<a class="card my-2 text-dark" href="DocURL"><div class="card-header h5">Title</div><div class=card-body>Content</div><div class=card-footer><figure class="avatar avatar-sm"><img class=s-circle src="Avatar"></figure><span style="font-size: smaller">MpName</span></div></a>`;
                for (x in card) {
                    part = part.replace(x, card[x]);
                }
                $("#main-end").before(part)
            });
            $("#load-more").attr("data", followTime);
        })
    }
</script>
</body>
</html>